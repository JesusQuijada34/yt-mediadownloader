#!/bin/bash

echo "ğŸ¬ YouTube Media Downloader - Instalador AutomÃ¡tico"
echo "=================================================="
echo ""

# Verificar si Python estÃ¡ instalado
if ! command -v python3 &> /dev/null; then
    echo "âŒ Python 3 no estÃ¡ instalado. Por favor, instala Python 3.7+ primero."
    echo "Descarga desde: https://www.python.org/downloads/"
    exit 1
fi

# Verificar versiÃ³n de Python
python_version=$(python3 -c "import sys; print(f'{sys.version_info.major}.{sys.version_info.minor}')")
required_version="3.7"

if [ "$(printf '%s\n' "$required_version" "$python_version" | sort -V | head -n1)" != "$required_version" ]; then
    echo "âŒ Se requiere Python 3.7 o superior. VersiÃ³n actual: $python_version"
    exit 1
fi

echo "âœ… Python $python_version detectado"
echo ""

# Verificar si pip estÃ¡ instalado
if ! command -v pip3 &> /dev/null; then
    echo "âŒ pip3 no estÃ¡ instalado. Por favor, instala pip3 primero."
    exit 1
fi

echo "âœ… pip3 detectado"
echo ""

# Actualizar pip
echo "ğŸ”„ Actualizando pip..."
pip3 install --upgrade pip

# Instalar dependencias desde requirements.txt
echo "ğŸ“¥ Instalando dependencias desde requirements.txt..."
if [ -f "lib/requirements.txt" ]; then
    pip3 install -r lib/requirements.txt
else
    echo "âš ï¸ No se encontrÃ³ requirements.txt, instalando dependencias bÃ¡sicas..."
    pip3 install yt-dlp PyQt5 PyQtWebEngine
fi

echo ""
echo "âœ… InstalaciÃ³n completada!"
echo ""
echo "ğŸš€ Para ejecutar la aplicaciÃ³n:"
echo "   python3 yt-mediadownloader.py"
echo ""
echo "ğŸ“– Para mÃ¡s informaciÃ³n, consulta README.md"
echo ""
echo "ğŸ¬ Â¡Disfruta descargando contenido de YouTube!"
echo ""
echo "ğŸ’¡ Consejo: Si encuentras problemas, ejecuta:"
echo "   pip3 install --upgrade yt-dlp"
